---
title: Advanced Example
description: Combine multiple features with custom UI and advanced functionality
icon: wand-magic-sparkles
---

This example demonstrates advanced usage of TableCalendar, combining multiple features including multi-selection, range selection, custom header, and holiday highlighting.

## What You'll Learn

<CardGroup cols={2}>
  <Card title="Custom Header" icon="heading">
    Build a custom calendar header with navigation controls
  </Card>
  <Card title="Page Controller" icon="gamepad">
    Programmatically control calendar navigation
  </Card>
  <Card title="Holiday Predicate" icon="gift">
    Mark specific days as holidays
  </Card>
  <Card title="Hybrid Selection" icon="layer-group">
    Switch between multi-selection and range selection
  </Card>
</CardGroup>

## Implementation

<Steps>
  <Step title="Set up advanced state management">
    Combine all selection modes with custom header control.

    ```dart
    class _TableComplexExampleState extends State<TableComplexExample> {
      late final ValueNotifier<List<Event>> _selectedEvents;
      final ValueNotifier<DateTime> _focusedDay = ValueNotifier(DateTime.now());
      final Set<DateTime> _selectedDays = LinkedHashSet<DateTime>(
        equals: isSameDay,
        hashCode: getHashCode,
      );

      late PageController _pageController;
      CalendarFormat _calendarFormat = CalendarFormat.month;
      RangeSelectionMode _rangeSelectionMode = RangeSelectionMode.toggledOff;
      DateTime? _rangeStart;
      DateTime? _rangeEnd;

      @override
      void initState() {
        super.initState();
        _selectedDays.add(_focusedDay.value);
        _selectedEvents = ValueNotifier(_getEventsForDay(_focusedDay.value));
      }
    }
    ```

    <Note>
      Using `ValueNotifier<DateTime>` for `_focusedDay` allows the custom header to update reactively without rebuilding the entire widget.
    </Note>
  </Step>

  <Step title="Implement hybrid selection logic">
    Support both multi-selection (tap) and range selection (long press).

    ```dart
    void _onDaySelected(DateTime selectedDay, DateTime focusedDay) {
      setState(() {
        if (_selectedDays.contains(selectedDay)) {
          _selectedDays.remove(selectedDay);
        } else {
          _selectedDays.add(selectedDay);
        }

        _focusedDay.value = focusedDay;
        _rangeStart = null;
        _rangeEnd = null;
        _rangeSelectionMode = RangeSelectionMode.toggledOff;
      });

      _selectedEvents.value = _getEventsForDays(_selectedDays);
    }

    void _onRangeSelected(DateTime? start, DateTime? end, DateTime focusedDay) {
      setState(() {
        _focusedDay.value = focusedDay;
        _rangeStart = start;
        _rangeEnd = end;
        _selectedDays.clear();
        _rangeSelectionMode = RangeSelectionMode.toggledOn;
      });

      if (start != null && end != null) {
        _selectedEvents.value = _getEventsForRange(start, end);
      } else if (start != null) {
        _selectedEvents.value = _getEventsForDay(start);
      } else if (end != null) {
        _selectedEvents.value = _getEventsForDay(end);
      }
    }
    ```
  </Step>

  <Step title="Create a custom header widget">
    Build a custom header with navigation buttons and action buttons.

    ```dart
    class _CalendarHeader extends StatelessWidget {
      final DateTime focusedDay;
      final VoidCallback onLeftArrowTap;
      final VoidCallback onRightArrowTap;
      final VoidCallback onTodayButtonTap;
      final VoidCallback onClearButtonTap;
      final bool clearButtonVisible;

      const _CalendarHeader({
        required this.focusedDay,
        required this.onLeftArrowTap,
        required this.onRightArrowTap,
        required this.onTodayButtonTap,
        required this.onClearButtonTap,
        required this.clearButtonVisible,
      });

      @override
      Widget build(BuildContext context) {
        final headerText = DateFormat.yMMM().format(focusedDay);

        return Padding(
          padding: const EdgeInsets.symmetric(vertical: 8.0),
          child: Row(
            children: [
              const SizedBox(width: 16.0),
              SizedBox(
                width: 120.0,
                child: Text(
                  headerText,
                  style: const TextStyle(fontSize: 26.0),
                ),
              ),
              IconButton(
                icon: const Icon(Icons.calendar_today, size: 20.0),
                visualDensity: VisualDensity.compact,
                onPressed: onTodayButtonTap,
              ),
              if (clearButtonVisible)
                IconButton(
                  icon: const Icon(Icons.clear, size: 20.0),
                  visualDensity: VisualDensity.compact,
                  onPressed: onClearButtonTap,
                ),
              const Spacer(),
              IconButton(
                icon: const Icon(Icons.chevron_left),
                onPressed: onLeftArrowTap,
              ),
              IconButton(
                icon: const Icon(Icons.chevron_right),
                onPressed: onRightArrowTap,
              ),
            ],
          ),
        );
      }
    }
    ```
  </Step>

  <Step title="Configure TableCalendar with advanced features">
    Set up the calendar with custom header, holiday predicate, and page controller access.

    ```dart
    TableCalendar<Event>(
      firstDay: kFirstDay,
      lastDay: kLastDay,
      focusedDay: _focusedDay.value,
      headerVisible: false,  // Hide default header
      selectedDayPredicate: (day) => _selectedDays.contains(day),
      rangeStartDay: _rangeStart,
      rangeEndDay: _rangeEnd,
      calendarFormat: _calendarFormat,
      rangeSelectionMode: _rangeSelectionMode,
      eventLoader: _getEventsForDay,
      holidayPredicate: (day) {
        // Every 20th day of the month will be treated as a holiday
        return day.day == 20;
      },
      onDaySelected: _onDaySelected,
      onRangeSelected: _onRangeSelected,
      onCalendarCreated: (controller) => _pageController = controller,
      onPageChanged: (focusedDay) => _focusedDay.value = focusedDay,
      onFormatChanged: (format) {
        if (_calendarFormat != format) {
          setState(() => _calendarFormat = format);
        }
      },
    )
    ```

    <Tip>
      Setting `headerVisible: false` allows you to use a completely custom header while still having full calendar functionality.
    </Tip>
  </Step>

  <Step title="Wire up the custom header">
    Use `ValueListenableBuilder` to connect the header to the calendar state.

    ```dart
    ValueListenableBuilder<DateTime>(
      valueListenable: _focusedDay,
      builder: (context, value, _) {
        return _CalendarHeader(
          focusedDay: value,
          clearButtonVisible: canClearSelection,
          onTodayButtonTap: () {
            setState(() => _focusedDay.value = DateTime.now());
          },
          onClearButtonTap: () {
            setState(() {
              _rangeStart = null;
              _rangeEnd = null;
              _selectedDays.clear();
              _selectedEvents.value = [];
            });
          },
          onLeftArrowTap: () {
            _pageController.previousPage(
              duration: const Duration(milliseconds: 300),
              curve: Curves.easeOut,
            );
          },
          onRightArrowTap: () {
            _pageController.nextPage(
              duration: const Duration(milliseconds: 300),
              curve: Curves.easeOut,
            );
          },
        );
      },
    )
    ```
  </Step>
</Steps>

## Complete Example

The complete example combines all features:

```dart
import 'dart:collection';
import 'package:flutter/material.dart';
import 'package:intl/intl.dart';
import 'package:table_calendar/table_calendar.dart';

class TableComplexExample extends StatefulWidget {
  const TableComplexExample({super.key});

  @override
  State<TableComplexExample> createState() => _TableComplexExampleState();
}

class _TableComplexExampleState extends State<TableComplexExample> {
  late final ValueNotifier<List<Event>> _selectedEvents;
  final ValueNotifier<DateTime> _focusedDay = ValueNotifier(DateTime.now());
  final Set<DateTime> _selectedDays = LinkedHashSet<DateTime>(
    equals: isSameDay,
    hashCode: getHashCode,
  );

  late PageController _pageController;
  CalendarFormat _calendarFormat = CalendarFormat.month;
  RangeSelectionMode _rangeSelectionMode = RangeSelectionMode.toggledOff;
  DateTime? _rangeStart;
  DateTime? _rangeEnd;

  @override
  void initState() {
    super.initState();
    _selectedDays.add(_focusedDay.value);
    _selectedEvents = ValueNotifier(_getEventsForDay(_focusedDay.value));
  }

  @override
  void dispose() {
    _focusedDay.dispose();
    _selectedEvents.dispose();
    super.dispose();
  }

  bool get canClearSelection =>
      _selectedDays.isNotEmpty || _rangeStart != null || _rangeEnd != null;

  List<Event> _getEventsForDay(DateTime day) {
    return kEvents[day] ?? [];
  }

  List<Event> _getEventsForDays(Iterable<DateTime> days) {
    return [
      for (final d in days) ..._getEventsForDay(d),
    ];
  }

  List<Event> _getEventsForRange(DateTime start, DateTime end) {
    final days = daysInRange(start, end);
    return _getEventsForDays(days);
  }

  void _onDaySelected(DateTime selectedDay, DateTime focusedDay) {
    setState(() {
      if (_selectedDays.contains(selectedDay)) {
        _selectedDays.remove(selectedDay);
      } else {
        _selectedDays.add(selectedDay);
      }

      _focusedDay.value = focusedDay;
      _rangeStart = null;
      _rangeEnd = null;
      _rangeSelectionMode = RangeSelectionMode.toggledOff;
    });

    _selectedEvents.value = _getEventsForDays(_selectedDays);
  }

  void _onRangeSelected(DateTime? start, DateTime? end, DateTime focusedDay) {
    setState(() {
      _focusedDay.value = focusedDay;
      _rangeStart = start;
      _rangeEnd = end;
      _selectedDays.clear();
      _rangeSelectionMode = RangeSelectionMode.toggledOn;
    });

    if (start != null && end != null) {
      _selectedEvents.value = _getEventsForRange(start, end);
    } else if (start != null) {
      _selectedEvents.value = _getEventsForDay(start);
    } else if (end != null) {
      _selectedEvents.value = _getEventsForDay(end);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('TableCalendar - Complex'),
      ),
      body: Column(
        children: [
          ValueListenableBuilder<DateTime>(
            valueListenable: _focusedDay,
            builder: (context, value, _) {
              return _CalendarHeader(
                focusedDay: value,
                clearButtonVisible: canClearSelection,
                onTodayButtonTap: () {
                  setState(() => _focusedDay.value = DateTime.now());
                },
                onClearButtonTap: () {
                  setState(() {
                    _rangeStart = null;
                    _rangeEnd = null;
                    _selectedDays.clear();
                    _selectedEvents.value = [];
                  });
                },
                onLeftArrowTap: () {
                  _pageController.previousPage(
                    duration: const Duration(milliseconds: 300),
                    curve: Curves.easeOut,
                  );
                },
                onRightArrowTap: () {
                  _pageController.nextPage(
                    duration: const Duration(milliseconds: 300),
                    curve: Curves.easeOut,
                  );
                },
              );
            },
          ),
          TableCalendar<Event>(
            firstDay: kFirstDay,
            lastDay: kLastDay,
            focusedDay: _focusedDay.value,
            headerVisible: false,
            selectedDayPredicate: (day) => _selectedDays.contains(day),
            rangeStartDay: _rangeStart,
            rangeEndDay: _rangeEnd,
            calendarFormat: _calendarFormat,
            rangeSelectionMode: _rangeSelectionMode,
            eventLoader: _getEventsForDay,
            holidayPredicate: (day) {
              // Every 20th day of the month will be treated as a holiday
              return day.day == 20;
            },
            onDaySelected: _onDaySelected,
            onRangeSelected: _onRangeSelected,
            onCalendarCreated: (controller) => _pageController = controller,
            onPageChanged: (focusedDay) => _focusedDay.value = focusedDay,
            onFormatChanged: (format) {
              if (_calendarFormat != format) {
                setState(() => _calendarFormat = format);
              }
            },
          ),
          const SizedBox(height: 8.0),
          Expanded(
            child: ValueListenableBuilder<List<Event>>(
              valueListenable: _selectedEvents,
              builder: (context, value, _) {
                return ListView.builder(
                  itemCount: value.length,
                  itemBuilder: (context, index) {
                    return Container(
                      margin: const EdgeInsets.symmetric(
                        horizontal: 12.0,
                        vertical: 4.0,
                      ),
                      decoration: BoxDecoration(
                        border: Border.all(),
                        borderRadius: BorderRadius.circular(12.0),
                      ),
                      child: ListTile(
                        onTap: () => print('${value[index]}'),
                        title: Text('${value[index]}'),
                      ),
                    );
                  },
                );
              },
            ),
          ),
        ],
      ),
    );
  }
}
```

## Key Features

### Custom Header

The custom header provides:
- Month/year display with custom formatting
- "Today" button to jump to current date
- "Clear" button (conditionally shown)
- Previous/next month navigation arrows

```dart
final headerText = DateFormat.yMMM().format(focusedDay);
```

### Page Controller Access

The `onCalendarCreated` callback provides access to the internal `PageController`:

```dart
onCalendarCreated: (controller) => _pageController = controller,
```

This allows programmatic navigation:

```dart
_pageController.nextPage(
  duration: const Duration(milliseconds: 300),
  curve: Curves.easeOut,
);
```

### Holiday Predicate

The `holidayPredicate` marks specific days as holidays, which can be styled differently:

```dart
holidayPredicate: (day) {
  // Every 20th day of the month will be treated as a holiday
  return day.day == 20;
}
```

<Tip>
  You can customize holiday styling using `CalendarStyle.holidayDecoration` and `CalendarStyle.holidayTextStyle`.
</Tip>

### Hybrid Selection Mode

The example supports both selection modes:
- **Tap**: Multi-select individual days (toggle on/off)
- **Long press**: Enter range selection mode

```dart
bool get canClearSelection =>
    _selectedDays.isNotEmpty || _rangeStart != null || _rangeEnd != null;
```

## Advanced Patterns

### Reactive Header Updates

Using `ValueNotifier` for `_focusedDay` allows the header to update without rebuilding the calendar:

```dart
final ValueNotifier<DateTime> _focusedDay = ValueNotifier(DateTime.now());

ValueListenableBuilder<DateTime>(
  valueListenable: _focusedDay,
  builder: (context, value, _) {
    return _CalendarHeader(focusedDay: value, ...);
  },
)
```

### Conditional UI Elements

Show the clear button only when there's something to clear:

```dart
if (clearButtonVisible)
  IconButton(
    icon: const Icon(Icons.clear, size: 20.0),
    onPressed: onClearButtonTap,
  )
```

### Smooth Navigation

Use animation curves for better UX:

```dart
_pageController.previousPage(
  duration: const Duration(milliseconds: 300),
  curve: Curves.easeOut,
);
```

## Customization Ideas

<CardGroup cols={2}>
  <Card title="Theme Integration" icon="palette">
    Use `Theme.of(context)` to match your app's color scheme
  </Card>
  <Card title="Localization" icon="language">
    Use `intl` package for multi-language support
  </Card>
  <Card title="Accessibility" icon="universal-access">
    Add semantic labels for screen readers
  </Card>
  <Card title="Animations" icon="sparkles">
    Animate selection changes and page transitions
  </Card>
</CardGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Styling" icon="palette" href="/customization/styling">
    Learn how to fully customize the calendar appearance
  </Card>
  <Card title="API Reference" icon="book" href="/api-reference">
    Explore all available properties and callbacks
  </Card>
</CardGroup>